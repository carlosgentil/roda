<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gráfico de Rosca</title>
</head>
<body>
    <canvas id="myCanvas" width="450" height="450"></canvas>

    <script>
	
	const hoje = new Date();
	const diaAtual = hoje.getDate(); // Dia atual (1-31)
	const mesAtual = hoje.getMonth() + 1; // Mês atual (0-11, por isso soma +1)

        function drawWedge(ctx, centerX, centerY, outerRadius, startAngle, endAngle, color, width) {
            ctx.beginPath();
            ctx.arc(centerX, centerY, outerRadius, startAngle, endAngle);
            ctx.arc(centerX, centerY, outerRadius - width, endAngle, startAngle, true);
            ctx.closePath();
            ctx.fillStyle = color;
            ctx.fill();
        }

        function drawDonutChart() {
            const canvas = document.getElementById("myCanvas");
            const ctx = canvas.getContext("2d");

            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const outerRadius = 180;  // Tamanho da rosca
            const innerRadius = outerRadius * 0.95;  // Criando o "buraco"

            /*
			drawWedge(ctx, centerX, centerY, outerRadius, (187 * Math.PI) / 180, (270 * Math.PI) / 180, "red", outerRadius - innerRadius);
            drawWedge(ctx, centerX, centerY, outerRadius, (110 * Math.PI) / 180, (187 * Math.PI) / 180, "yellow", outerRadius - innerRadius);
            drawWedge(ctx, centerX, centerY, outerRadius, (-30 * Math.PI) / 180, (110 * Math.PI) / 180, "blue", outerRadius - innerRadius);
            drawWedge(ctx, centerX, centerY, outerRadius, (-90 * Math.PI) / 180, (-30 * Math.PI) / 180, "green", outerRadius - innerRadius);
			*/

			drawWedge(ctx, centerX, centerY, outerRadius, (90 * Math.PI) / 180, ((90+83) * Math.PI) / 180, "red", outerRadius - innerRadius);
            drawWedge(ctx, centerX, centerY, outerRadius, ((90+83) * Math.PI) / 180, ((90+83+77) * Math.PI) / 180, "yellow", outerRadius - innerRadius);
            drawWedge(ctx, centerX, centerY, outerRadius, ((90+83+77) * Math.PI) / 180, ((90-60) * Math.PI) / 180, "blue", outerRadius - innerRadius);
            drawWedge(ctx, centerX, centerY, outerRadius, ((90-60) * Math.PI) / 180, (90 * Math.PI) / 180, "green", outerRadius - innerRadius);
			}
 //Centralizar no meio do canvas

drawDonutChart();

  const canvas = document.getElementById("myCanvas");
  const ctx = canvas.getContext("2d");

  // Centralizar no meio do canvas
  const centerX = canvas.width / 2;
  const centerY = canvas.height / 2;
  const scale = 180; // Ajuste para converter os raios em pixels

  function drawCircle(x, y, radius, color, lineWidth) {
    ctx.beginPath();
    ctx.arc(x, y, radius * scale, 0, 2 * Math.PI);
    ctx.strokeStyle = color;
    ctx.lineWidth = lineWidth;
    ctx.stroke();
  }

  drawCircle(centerX, centerY, 0.92, "black", 2);
  drawCircle(centerX, centerY, 0.25, "black", 2);
  drawCircle(centerX, centerY, 0.15, "black", 2);
  drawCircle(centerX, centerY, 0.945, "black", 2);
  drawCircle(centerX, centerY, 1, "black", 2);

let diaAtualA = diaAtual > 30 ? 30 : diaAtual;

const angleAjuste = Math.PI / 2 + (mesAtual -1) * Math.PI / 6 + (diaAtualA-1)* Math.PI / 180; // Ajuste para começar em cima (90º); // Defina o ajuste de ângulo conforme necessário
  const totalDivisions = 72;
  const angleStep = (2 * Math.PI) / totalDivisions; // Ângulo entre cada divisão

  function drawLine(x1, y1, x2, y2, color, lineWidth) {
    ctx.beginPath();
    ctx.moveTo(x1, y1);
    ctx.lineTo(x2, y2);
    ctx.strokeStyle = color;
    ctx.lineWidth = lineWidth;
    ctx.stroke();
  }

  for (let i = 0; i < totalDivisions; i++) {
    const angle = i * angleStep + angleAjuste;

    const x1 = centerX + 0.92 * scale * Math.cos(angle);
    const y1 = centerY + 0.92 * scale * Math.sin(angle);
    const x2 = centerX + 0.25 * scale * Math.cos(angle);
    const y2 = centerY + 0.25 * scale * Math.sin(angle);
    const x3 = centerX + 0.15 * scale * Math.cos(angle);
    const y3 = centerY + 0.15 * scale * Math.sin(angle);

    if (i % 6 === 0) {
      drawLine(x1, y1, x3, y3, "black", 1.5); // Linhas mais grossas para múltiplos de 6
    } else {
      drawLine(x1, y1, x2, y2, "gray", 0.5); // Linhas normais
    }
  }
  //const mes_atual=5
  
  const months = ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"];
  const angleAdjust = Math.PI / 2 + (mesAtual -1) * Math.PI / 6 + (diaAtualA-1)* Math.PI / 180; // Ajuste para começar em cima (90º)
  const monthAngles = 2 * Math.PI / 12; // Ângulo entre os meses

  function drawText(text, x, y, fontSize, fontWeight) {
    ctx.font = `${fontWeight} ${fontSize}px Arial`;
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";
	ctx.fillStyle = "black";
    ctx.fillText(text, x, y);
  }

  for (let i = 0; i < months.length; i++) {
    const angle = (months.length-i-1) * monthAngles + angleAdjust;

    const x1 = centerX + 0.92 * scale * Math.cos(angle);
    const y1 = centerY + 0.92 * scale * Math.sin(angle);

    const x2 = centerX + 0.2 * scale * Math.cos(angle + monthAngles / 2);
    const y2 = centerY + 0.2 * scale * Math.sin(angle + monthAngles / 2);

    const x3 = centerX + 0.15 * scale * Math.cos(angle);
    const y3 = centerY + 0.15 * scale * Math.sin(angle);

    // Desenha os textos dos meses
    drawText(months[i], x2, y2, 9, "bold");

    // Opcional: Linhas radiais para marcação
    ctx.beginPath();
    ctx.moveTo(x1, y1);
    ctx.lineTo(x3, y3);
    ctx.strokeStyle = "gray";
    ctx.lineWidth = 0.5;
    ctx.stroke();
  }
  
  function drawMark(angleDeg, text1, text2, text3) {
    const angle = (angleDeg * Math.PI) / 180;

    drawLine2(angle, 0.95, 1.0, "black", 1.5);
	
	if(text1 == "cobertura"){
		drawText(text1, centerX + 1.14 * scale * Math.cos(angle), centerY + 1.06 * scale * Math.sin(angle), 12);
		drawText(text2, centerX + 1.12 * scale * Math.cos(angle), centerY + 1.46 * scale * Math.sin(angle), 12);
	} else if(text1 == "retorno") { 
		drawText(text1, centerX + 1.12 * scale * Math.cos(angle), centerY + 1.16 * scale * Math.sin(angle), 12);
		drawText(text2, centerX + 1.12 * scale * Math.cos(angle), centerY + 0.95 * scale * Math.sin(angle), 12);
		drawText(text3, centerX + 1.12 * scale * Math.cos(angle), centerY + 0.75 * scale * Math.sin(angle), 12);
	} else if(text2 == "40 dias") {
		drawText(text1, centerX + 1.12 * scale * Math.cos(angle), centerY + 1.10 * scale * Math.sin(angle), 12);
		drawText(text2, centerX + 1.16 * scale * Math.cos(angle), centerY + 0.97 * scale * Math.sin(angle), 12);
	} else if(text2 == "60 dias") {
		drawText(text1, centerX + 1.18 * scale * Math.cos(angle), centerY + 1.08 * scale * Math.sin(angle), 12);
		drawText(text2, centerX + 1.26 * scale * Math.cos(angle), centerY + 1.00 * scale * Math.sin(angle), 12);
	} else {
    drawText(text1, centerX + 1.08 * scale * Math.cos(angle), centerY + 1.06 * scale * Math.sin(angle), 12);
    if (text2) drawText(text2, centerX + 1.05 * scale * Math.cos(angle), centerY + 1.00 * scale * Math.sin(angle), 12);
    if (text3) drawText(text3, centerX + 1.05 * scale * Math.cos(angle), centerY + 0.9 * scale * Math.sin(angle), 12);
	}
  }
  drawLine2(-90 * Math.PI / 180 , 0.95, 1.0, "black", 1.5);
  drawLine2(-60 * Math.PI / 180, 0.95, 1.0, "black", 1.5);
  drawLine2(-30 * Math.PI / 180, 0.95, 1.0, "black", 1.5);
  drawLine2( 0 * Math.PI / 180, 0.95, 1.0, "black", 1.5);
  drawLine2( 30 * Math.PI / 180, 0.95, 1.0, "black", 1.5);
  drawLine2( 60 * Math.PI / 180, 0.95, 1.0, "black", 1.5);
  drawLine2( 90 * Math.PI / 180, 0.95, 1.0, "black", 1.5);
  drawLine2( 120 * Math.PI / 180, 0.95, 1.0, "black", 1.5);
  drawLine2( 150 * Math.PI / 180, 0.95, 1.0, "black", 1.5);
  
  
 function drawLine2(angle, length1, length2, color, lineWidth) {
    const x1 = centerX + length1 * scale * Math.cos(angle);
    const y1 = centerY + length1 * scale * Math.sin(angle);
    const x2 = centerX + length2 * scale * Math.cos(angle);
    const y2 = centerY + length2 * scale * Math.sin(angle);

    ctx.beginPath();
    ctx.moveTo(x1, y1);
    ctx.lineTo(x2, y2);
    ctx.strokeStyle = color;
    ctx.lineWidth = lineWidth;
    ctx.stroke();
  }

  drawMark(173, "cobertura", "83 dias", "");
  drawMark(194, "retorno", "ao cio", "21 dias");
  drawMark(213, "palpar", "40 dias", "");
  drawMark(233, "palpar", "60 dias", "");
	
  drawText("secar", centerX + 1.08 * scale * Math.cos(30 * Math.PI / 180), centerY + 1.06 * scale * Math.sin(30 * Math.PI / 180), 12);
  drawText("Hoje", centerX, centerY + 1.05 * scale, 12, true);
  drawText("Parição", centerX, centerY + 1.10 * scale, 12, true);


  // Texto central
  drawText("Faz", centerX, centerY - 0.08 * scale, 14, true);
  drawText("Estiva", centerX, centerY, 14, true);
  drawText("27 / Fev", centerX, centerY + 0.08 * scale, 12, true);
        
    </script>
</body>
</html>
